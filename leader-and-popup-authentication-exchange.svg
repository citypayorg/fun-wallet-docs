<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1229" height="682"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1229" height="682"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.0584718928536" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Leader And Popup Authentication Exchange</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 40.96287620999219 95.887643371 L 40.96287620999219 682.3214418409999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.87624969365106 95.887643371 L 189.87624969365106 682.3214418409999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 657.0823011212552 95.887643371 L 657.0823011212552 682.3214418409999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1185.6984782812815 95.887643371 L 1185.6984782812815 682.3214418409999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 73.75815076998438 51.782594461 L 73.75815076998438 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SDK</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 150.95714243102213 51.782594461 L 228.79535695627996 51.782594461 L 228.79535695627996 95.887643371 L 150.95714243102213 95.887643371 L 150.95714243102213 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.68083801152216" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Popup</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 560.6005946764974 51.782594461 L 753.5640075660131 51.782594461 L 753.5640075660131 95.887643371 L 560.6005946764974 95.887643371 L 560.6005946764974 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="578.3242902569974" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">FunWalletClient (leader)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1150.4515206768558 51.782594461 L 1220.9454358857074 51.782594461 L 1220.9454358857074 95.887643371 L 1150.4515206768558 95.887643371 L 1150.4515206768558 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1168.1752162573557" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Dapp</text></g></g><g><g><g><rect fill="white" stroke="none" x="68.96070701736849" y="128.558049971" width="92.91771186890625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.4109875123685" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Window.open</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 40.96287620999219 149.793814261 L 187.15371581031772 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(189.87624969365106,149.793814261) translate(-189.87624969365106,-149.793814261)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 176.26358027698438 142.98747955266666 L 189.87624969365106 149.793814261 L 176.26358027698438 156.60014896933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="341.5802034085469" y="174.296619211" width="163.7981439978125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="344.0304839035469" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate a RSA keypair</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.87624969365106 195.532383501 L 654.3597672379219 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(657.0823011212552,195.532383501) translate(-657.0823011212552,-195.532383501)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 643.4696317045886 188.72604879266666 L 657.0823011212552 195.532383501 L 643.4696317045886 202.33871820933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="387.6217149441914" y="220.035188451" width="71.71512092652344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.0719954391914" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 657.0823011212552 241.270952741 L 192.5987835769844 241.270952741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(189.87624969365106,241.270952741) translate(-189.87624969365106,-241.270952741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 203.48891911031774 234.46461803266666 L 189.87624969365106 241.270952741 L 203.48891911031774 248.07728744933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="209.20624026531775" y="265.773757691" width="40.770266190195315" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.65652076031773" y="280.475440661" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Login</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.87624969365106 287.009521981 L 255.21706289365108 287.009521981 L 255.21706289365108 308.245286271 L 192.5987835769844 308.245286271" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(189.87624969365106,308.245286271) translate(-189.87624969365106,-308.245286271)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 203.48891911031774 301.43895156266666 L 189.87624969365106 308.245286271 L 203.48891911031774 315.05162097933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="209.20624026531775" y="332.74809122100004" width="442.1587397009375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.65652076031773" y="347.449774191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypt private key, JWT and more context with the RSA public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.87624969365106 353.983855511 L 255.21706289365108 353.983855511 L 255.21706289365108 375.219619801 L 192.5987835769844 375.219619801" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(189.87624969365106,375.219619801) translate(-189.87624969365106,-375.219619801)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 203.48891911031774 368.4132850926667 L 189.87624969365106 375.219619801 L 203.48891911031774 382.02595450933336 Z"/></g></g><g><g><rect fill="white" stroke="none" x="337.4964631741719" y="399.722424751" width="171.9656244665625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.9467436691719" y="414.424107721" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Broadcast encrypted data</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.87624969365106 420.958189041 L 654.3597672379219 420.958189041" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(657.0823011212552,420.958189041) translate(-657.0823011212552,-420.958189041)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 643.4696317045886 414.1518543326667 L 657.0823011212552 420.958189041 L 643.4696317045886 427.76452374933336 Z"/></g></g><g><g><rect fill="white" stroke="none" x="676.4122916929219" y="445.46099399100007" width="503.56886543335935" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="678.862572187922" y="460.16267696100005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Decrypt the encrypted data with the RSA private key (held in leader memory)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 657.0823011212552 466.69675828100003 L 722.4231143212552 466.69675828100003 L 722.4231143212552 487.93252257100005 L 659.8048350045885 487.93252257100005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(657.0823011212552,487.93252257100005) translate(-657.0823011212552,-487.93252257100005)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 670.6949705379219 481.1261878626667 L 657.0823011212552 487.93252257100005 L 670.6949705379219 494.7388572793334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="219.43920575363157" y="512.435327521" width="259.16676582398435" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="221.88948624863156" y="527.137010491" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authenticationCompleted event emitted</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 657.0823011212552 533.671091811 L 43.68541009332552 533.671091811" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(40.96287620999219,533.671091811) translate(-40.96287620999219,-533.671091811)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.57554562665886 526.8647571026667 L 40.96287620999219 533.671091811 L 54.57554562665886 540.4774265193333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="480.8983410865743" y="558.1738967609999" width="264.864672318125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.3486215815743" y="572.8755797309999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Emit the authenticationCompleted event</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 40.96287620999219 579.409661051 L 1182.975944397948 579.409661051" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1185.6984782812815,579.409661051) translate(-1185.6984782812815,-579.409661051)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1172.0858088646148 572.6033263426666 L 1185.6984782812815 579.409661051 L 1172.0858088646148 586.2159957593333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="68.15541679520052" y="603.9124660009999" width="94.52829231324219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="70.60569729020052" y="618.6141489709998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Window.close</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 40.96287620999219 625.1482302909999 L 187.15371581031772 625.1482302909999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(189.87624969365106,625.1482302909999) translate(-189.87624969365106,-625.1482302909999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 176.26358027698438 618.3418955826666 L 189.87624969365106 625.1482302909999 L 176.26358027698438 631.9545649993332 Z"/></g></g></g><g/><g/><g/><g/></g></svg>