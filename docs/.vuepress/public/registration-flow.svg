<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1621" height="1084"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1621" height="1084"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="729.5365156808093" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Registration flow</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 95.887643371 L 44.631447682160164 1084.1674430209996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 95.887643371 L 781.8087515511706 1084.1674430209996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1548.1484699709624 95.887643371 L 1548.1484699709624 1084.1674430209996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 81.09529371432032 51.782594461 L 81.09529371432032 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.891297230500008" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 742.4959522719402 51.782594461 L 821.1215508304011 51.782594461 L 821.1215508304011 95.887643371 L 742.4959522719402 95.887643371 L 742.4959522719402 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="760.2196478524402" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1482.7655336678063 51.782594461 L 1613.5314062741188 51.782594461 L 1613.5314062741188 95.887643371 L 1482.7655336678063 95.887643371 L 1482.7655336678063 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1500.4892292483062" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Email Provider</text></g></g><g><g><g><rect fill="white" stroke="none" x="345.58373818904823" y="128.558049971" width="135.27272285523438" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="348.03401868404825" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enter email address</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 149.793814261 L 779.0862176678373 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,149.793814261) translate(-781.8087515511706,-149.793814261)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 768.196082134504 142.98747955266666 L 781.8087515511706 149.793814261 L 768.196082134504 156.60014896933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1089.1819099779807" y="174.296619211" width="151.59340156617188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1091.6321904729807" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send registration code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 195.532383501 L 1545.425936087629 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1548.1484699709624,195.532383501) translate(-1548.1484699709624,-195.532383501)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1534.5358005542957 188.72604879266666 L 1548.1484699709624 195.532383501 L 1534.5358005542957 202.33871820933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="371.2673243096537" y="220.035188451" width="83.90555061402344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="373.7176048046537" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Device JWT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 241.270952741 L 47.3539815654935 241.270952741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,241.270952741) translate(-44.631447682160164,-241.270952741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 234.46461803266666 L 44.631447682160164 241.270952741 L 58.244117098826834 248.07728744933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="337.0225428155131" y="265.77375769099996" width="152.3951136023047" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.4728233105131" y="280.47544066099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enter registration code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 287.009521981 L 779.0862176678373 287.009521981" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,287.009521981) translate(-781.8087515511706,-287.009521981)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 768.196082134504 280.20318727266664 L 781.8087515511706 287.009521981 L 768.196082134504 293.8158566893333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="801.1387421228374" y="311.512326931" width="169.24548591675781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="803.5890226178374" y="326.214009901" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate registration code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 332.748091221 L 847.1495647511706 332.748091221 L 847.1495647511706 353.983855511 L 784.531285434504 353.983855511" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,353.983855511) translate(-781.8087515511706,-353.983855511)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 795.4214209678373 347.17752080266666 L 781.8087515511706 353.983855511 L 795.4214209678373 360.79019021933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="354.5601023247904" y="378.486660461" width="117.31999458375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="357.01038281979044" y="393.18834343099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Registration JWT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 399.722424751 L 47.3539815654935 399.722424751" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,399.722424751) translate(-44.631447682160164,-399.722424751)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 392.91609004266667 L 44.631447682160164 399.722424751 L 58.244117098826834 406.52875945933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="63.96143825382683" y="424.22522970100005" width="250.19037117066406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882683" y="438.926912671" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Choose password and check strength</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 445.460993991 L 109.97226088216016 445.460993991 L 109.97226088216016 466.69675828100003 L 47.3539815654935 466.69675828100003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,466.69675828100003) translate(-44.631447682160164,-466.69675828100003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 459.8904235726667 L 44.631447682160164 466.69675828100003 L 58.244117098826834 473.50309298933337 Z"/></g></g><g><g><rect fill="white" stroke="none" x="63.96143825382683" y="491.199563231" width="712.1299921423438" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882683" y="505.901246201" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate 32 byte master key PBKDF2 (salt: keccak(email), password: keccak(password), iterations: 100000)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 512.435327521 L 109.97226088216016 512.435327521 L 109.97226088216016 533.671091811 L 47.3539815654935 533.671091811" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,533.671091811) translate(-44.631447682160164,-533.671091811)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 526.8647571026667 L 44.631447682160164 533.671091811 L 58.244117098826834 540.4774265193333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="63.96143825382683" y="558.1738967609999" width="412.3162714392187" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882683" y="572.8755797309999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate 32 byte authentication key (key keccak(master_key))</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 579.409661051 L 109.97226088216016 579.409661051 L 109.97226088216016 600.645425341 L 47.3539815654935 600.645425341" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,600.645425341) translate(-44.631447682160164,-600.645425341)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 593.8390906326666 L 44.631447682160164 600.645425341 L 58.244117098826834 607.4517600493333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="63.96143825382683" y="625.1482302909999" width="528.5796991735938" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882683" y="639.8499132609999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Ethereum private key (crypto.getRandomValues(32_bytes_uint8array))</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 646.3839945809999 L 109.97226088216016 646.3839945809999 L 109.97226088216016 667.6197588709999 L 47.3539815654935 667.6197588709999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,667.6197588709999) translate(-44.631447682160164,-667.6197588709999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 660.8134241626666 L 44.631447682160164 667.6197588709999 L 58.244117098826834 674.4260935793333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="63.96143825382683" y="692.1225638209999" width="313.662035599375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882683" y="706.8242467909998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypt private key with master key (AES CBC)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 713.3583281109999 L 109.97226088216016 713.3583281109999 L 109.97226088216016 734.5940924009999 L 47.3539815654935 734.5940924009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,734.5940924009999) translate(-44.631447682160164,-734.5940924009999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 727.7877576926666 L 44.631447682160164 734.5940924009999 L 58.244117098826834 741.4004271093332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="264.89658914119667" y="759.0968973509998" width="296.6470209509375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.3468696361967" y="773.7985803209998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypted private key and authentication key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 780.3326616409998 L 779.0862176678373 780.3326616409998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,780.3326616409998) translate(-781.8087515511706,-780.3326616409998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 768.196082134504 773.5263269326665 L 781.8087515511706 780.3326616409998 L 768.196082134504 787.1389963493332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="801.1387421228374" y="804.8354665909998" width="146.69006599488281" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="803.5890226178374" y="819.5371495609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate random salt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 826.0712308809998 L 847.1495647511706 826.0712308809998 L 847.1495647511706 847.3069951709998 L 784.531285434504 847.3069951709998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,847.3069951709998) translate(-781.8087515511706,-847.3069951709998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 795.4214209678373 840.5006604626665 L 781.8087515511706 847.3069951709998 L 795.4214209678373 854.1133298793332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="801.1387421228374" y="871.8098001209997" width="741.292406693125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="803.5890226178374" y="886.5114830909997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate authentication key hash (PBKDF2(salt: random_salt, password: authentication_key, iterations: 100000))</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 893.0455644109998 L 847.1495647511706 893.0455644109998 L 847.1495647511706 914.2813287009998 L 784.531285434504 914.2813287009998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,914.2813287009998) translate(-781.8087515511706,-914.2813287009998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 795.4214209678373 907.4749939926664 L 781.8087515511706 914.2813287009998 L 795.4214209678373 921.0876634093331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="801.1387421228374" y="938.7841336509997" width="399.8681513220312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="803.5890226178374" y="953.4858166209997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store encrypted private key, salt and authentication key hash</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 960.0198979409997 L 847.1495647511706 960.0198979409997 L 847.1495647511706 981.2556622309997 L 784.531285434504 981.2556622309997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(781.8087515511706,981.2556622309997) translate(-781.8087515511706,-981.2556622309997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 795.4214209678373 974.4493275226664 L 781.8087515511706 981.2556622309997 L 795.4214209678373 988.0619969393331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="393.24655709773964" y="1005.7584671809997" width="39.947085037851565" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="395.69683759273966" y="1020.4601501509997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Done</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 781.8087515511706 1026.9942314709997 L 47.3539815654935 1026.9942314709997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,1026.9942314709997) translate(-44.631447682160164,-1026.9942314709997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 1020.1878967626664 L 44.631447682160164 1026.9942314709997 L 58.244117098826834 1033.800566179333 Z"/></g></g></g><g/><g/><g/></g></svg>